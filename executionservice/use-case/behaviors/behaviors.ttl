@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rdf4j: <http://rdf4j.org/schema/rdf4j#> .
@prefix sesame: <http://www.openrdf.org/schema/sesame#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix fn: <http://www.w3.org/2005/xpath-functions#> .

<http://localhost:8090/rdf4j/repositories/behaviors#BT_dae41a94-6793-4c71-a188-817651a9bc7d>
  a <http://www.ajan.de/behavior/bt-ns#BehaviorTree>, <http://www.ajan.de/behavior/bt-ns#Root>;
  rdfs:label "asp_test_BT";
  <http://www.ajan.de/behavior/bt-ns#hasChild> <http://localhost:8090/rdf4j/repositories/behaviors#Priority-fd8707da-11b0-48ef-ba67-a236f4caf936> .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b256 a <http://www.ajan.de/behavior/bt-ns#UpdateQuery>;
  <http://www.ajan.de/behavior/bt-ns#originBase> <http://www.ajan.de/ajan-ns#AgentKnowledge>;
  <http://www.ajan.de/behavior/bt-ns#sparql> """PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX suite: <http://www.dfki.de/suite-ns#>
PREFIX asp: <http://www.ajan.de/behavior/asp-ns#>

DELETE {
	?bk ?p ?o .
}
INSERT {
	GRAPH <http://localhost:8090/rdf4j/repositories/domain#ASP> {
		<http://localhost:8090/rdf4j/repositories/domain#BK_Rules>
			a asp:RuleSet ;
			asp:asRules ?rules .
	}
}
WHERE {
	?bk rdf:type suite:BackgroundKnowledge .
	?bk ?p ?o .

	{ SELECT (GROUP_CONCAT (DISTINCT ?rule; SEPARATOR = \" \") AS ?rules)
		WHERE {
			?s rdf:type suite:BackgroundKnowledge ;
				suite:rule ?rule .
		}
	}
}""" .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b257 a <http://www.ajan.de/behavior/bt-ns#ConstructQuery>;
  <http://www.ajan.de/behavior/bt-ns#sparql> """CONSTRUCT
WHERE {
?s ?p ?o
}""";
  <http://www.ajan.de/behavior/bt-ns#targetBase> <http://www.ajan.de/ajan-ns#AgentKnowledge> .

<http://localhost:8090/rdf4j/repositories/behaviors#Update-3cc5abc7-2267-4258-87e6-d684d0fbf910>
  a <http://www.ajan.de/behavior/bt-ns#Update>;
  <http://www.ajan.de/behavior/bt-ns#useW3C> false;
  rdfs:label "add_initials";
  rdfs:comment "";
  <http://www.ajan.de/behavior/bt-ns#query> _:genid-507939f1b83a43529ae9841b73a3dc3d-b270 .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b258 a <http://www.w3.org/2006/http#Request>;
  <http://www.ajan.de/behavior/bt-ns#headers> _:genid-507939f1b83a43529ae9841b73a3dc3d-b259;
  <http://www.w3.org/2006/http#headers> _:genid-507939f1b83a43529ae9841b73a3dc3d-b260;
  <http://www.w3.org/2006/http#httpVersion> "1.1";
  <http://www.w3.org/2006/http#mthd> <http://www.w3.org/2008/http-methods#POST> .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b260 rdf:first _:genid-507939f1b83a43529ae9841b73a3dc3d-b261;
  rdf:rest rdf:nil .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b259 a <http://www.ajan.de/behavior/bt-ns#SelectQuery>;
  <http://www.ajan.de/behavior/bt-ns#originBase> <http://www.ajan.de/ajan-ns#AgentKnowledge>;
  <http://www.ajan.de/behavior/bt-ns#sparql> "" .

<http://localhost:8090/rdf4j/repositories/behaviors#ILASPInput-b00de8e4-2795-4577-9b2f-4a1a8d172e90>
  a <http://www.ajan.de/behavior/asp-ns#ILASPInput>;
  rdfs:label "ILASPInput_test";
  rdfs:comment "";
  <http://www.ajan.de/behavior/asp-ns#config> _:genid-507939f1b83a43529ae9841b73a3dc3d-b264;
  <http://www.ajan.de/behavior/asp-ns#domain> _:genid-507939f1b83a43529ae9841b73a3dc3d-b262;
  <http://www.ajan.de/behavior/asp-ns#negExamples> _:genid-507939f1b83a43529ae9841b73a3dc3d-b263;
  <http://www.ajan.de/behavior/asp-ns#posExamples> _:genid-507939f1b83a43529ae9841b73a3dc3d-b267;
  <http://www.ajan.de/behavior/asp-ns#ruleSets> _:genid-507939f1b83a43529ae9841b73a3dc3d-b271;
  <http://www.ajan.de/behavior/bt-ns#binding> _:genid-507939f1b83a43529ae9841b73a3dc3d-b258;
  <http://www.ajan.de/behavior/bt-ns#queryUri> _:genid-507939f1b83a43529ae9841b73a3dc3d-b268 .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b261 a <http://www.w3.org/2006/http#Header>;
  <http://www.w3.org/2006/http#fieldValue> "application/json";
  <http://www.w3.org/2006/http#hdrName> <http://www.w3.org/2008/http-headers#content-type> .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b262 a <http://www.ajan.de/behavior/bt-ns#ConstructQuery>;
  <http://www.ajan.de/behavior/bt-ns#originBase> <http://www.ajan.de/ajan-ns#AgentKnowledge>;
  <http://www.ajan.de/behavior/bt-ns#sparql> """PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX suite: <http://www.dfki.de/suite-ns#>

CONSTRUCT {
	?a1 rdf:type suite:Activity ;
		suite:activityID ?id1 ;
		suite:activityType ?type1 .
		
	?a2 rdf:type suite:Activity ;
		suite:activityID ?id2 ;
		suite:activityType ?type2 .

	?bf rdf:type suite:Before ;
		suite:activity1 ?a1 ;
		suite:activity2 ?a2 ;
		suite:timeRange ?time .
}
WHERE {
	?a1 rdf:type suite:Activity ;
		suite:activityID ?id1 ;
		suite:activityType ?type1 .
		
	?a2 rdf:type suite:Activity ;
		suite:activityID ?id2 ;
		suite:activityType ?type2 .

	?bf rdf:type suite:Before ;
		suite:activity1 ?a1 ;
		suite:activity2 ?a2 ;
		suite:seconds ?diff .
		
	BIND ( IF (?diff < 3600, \"s\", IF (?diff < 28800, \"m\", \"l\")) AS ?time)

	FILTER NOT EXISTS {
		?o rdf:type suite:Before ;
			suite:activity1 ?a1 ;
			suite:seconds ?other .
		FILTER ( ?other < ?diff )
	}
}""" .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b263 a <http://www.ajan.de/behavior/bt-ns#SelectQuery>,
    <http://www.ajan.de/behavior/bt-ns#QueryUri>;
  <http://www.ajan.de/behavior/bt-ns#originBase> <http://www.ajan.de/ajan-ns#AgentKnowledge>;
  <http://www.ajan.de/behavior/bt-ns#sparql> """SELECT ?neg
WHERE {
  VALUES ?neg {\"456\"}
}""" .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b264 a <http://www.ajan.de/behavior/clingo-ns#Config>;
  <http://www.ajan.de/behavior/clingo-ns#const> _:genid-507939f1b83a43529ae9841b73a3dc3d-b265;
  <http://www.ajan.de/behavior/clingo-ns#execution-limit> "5"^^xsd:int;
  <http://www.ajan.de/behavior/clingo-ns#models> "5"^^xsd:int;
  <http://www.ajan.de/behavior/clingo-ns#parallel-mode> "2"^^xsd:int;
  <http://www.ajan.de/behavior/clingo-ns#time-limit> "5"^^xsd:int .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b265 rdf:first _:genid-507939f1b83a43529ae9841b73a3dc3d-b266;
  rdf:rest rdf:nil .

<http://localhost:8090/rdf4j/repositories/behaviors#Sequence-275e9622-3377-4f0b-abdb-5c95a3d4a1db>
  a <http://www.ajan.de/behavior/bt-ns#Sequence>;
  rdfs:label "defaultSequence";
  <http://www.ajan.de/behavior/bt-ns#hasChildren> _:genid-507939f1b83a43529ae9841b73a3dc3d-b274 .

<http://localhost:8090/rdf4j/repositories/behaviors#Update-ed160a97-8efe-4fb9-a6eb-d3f4016e384b>
  a <http://www.ajan.de/behavior/bt-ns#Update>;
  <http://www.ajan.de/behavior/bt-ns#useW3C> false;
  rdfs:label "createBefores";
  rdfs:comment "";
  <http://www.ajan.de/behavior/bt-ns#query> _:genid-507939f1b83a43529ae9841b73a3dc3d-b269 .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b266 a <http://www.ajan.de/behavior/clingo-ns#Constant>;
  <http://www.ajan.de/behavior/clingo-ns#name> "";
  <http://www.ajan.de/behavior/clingo-ns#value> "5" .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b267 a <http://www.ajan.de/behavior/bt-ns#SelectQuery>,
    <http://www.ajan.de/behavior/bt-ns#QueryUri>;
  <http://www.ajan.de/behavior/bt-ns#originBase> <http://www.ajan.de/ajan-ns#AgentKnowledge>;
  <http://www.ajan.de/behavior/bt-ns#sparql> """SELECT ?pos
WHERE {
  VALUES ?pos {\"123\"}
}""" .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b268 a <http://www.ajan.de/behavior/bt-ns#SelectQuery>,
    <http://www.ajan.de/behavior/bt-ns#QueryUri>;
  <http://www.ajan.de/behavior/bt-ns#originBase> <http://www.ajan.de/ajan-ns#AgentKnowledge>;
  <http://www.ajan.de/behavior/bt-ns#sparql> """SELECT ?requestURI
WHERE {
  VALUES ?requestURI {\"http://localhost:3000/test\"}
}""" .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b269 a <http://www.ajan.de/behavior/bt-ns#UpdateQuery>;
  <http://www.ajan.de/behavior/bt-ns#originBase> <http://www.ajan.de/ajan-ns#AgentKnowledge>;
  <http://www.ajan.de/behavior/bt-ns#sparql> """PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX suite: <http://www.dfki.de/suite-ns#>

INSERT {
	?bnode rdf:type suite:Before ;
		suite:activity1 ?a1 ;
		suite:activity2 ?a2 ;
		suite:seconds ?diff .
}
WHERE {
	?a1 rdf:type suite:Activity .
	?a1 suite:activityID ?id1 .
	
	?a2 rdf:type suite:Activity .
	?a2 suite:activityID ?id2 .
	BIND(BNODE() AS ?bnode)

	{ SELECT ?id1 ?id2 ?diff
		WHERE {
			?a1 suite:activityID ?id1 .
			?a1 suite:from ?date1 .
			
			?a2 suite:activityID ?id2 .
			?a2 suite:from ?date2 .
			
			FILTER (?a1 != ?a2)
			
			BIND (HOURS(?date1) * 60 AS ?date1minutes1)
			BIND (MINUTES(?date1) AS ?date1minutes2)
			BIND (?date1minutes1 + ?date1minutes2 AS ?date1addMinutes)
			BIND (?date1addMinutes * 60 AS ?date1seconds1)
			BIND (SECONDS(?date1) AS ?date1seconds2)
			BIND (?date1seconds1 + ?date1seconds2 AS ?date1addSeconds)
			
			BIND (HOURS(?date2) * 60 AS ?date2minutes1)
			BIND (MINUTES(?date2) AS ?date2minutes2)
			BIND (?date2minutes1 + ?date2minutes2 AS ?date2addMinutes)
			BIND (?date2addMinutes * 60 AS ?date2seconds1)
			BIND (SECONDS(?date2) AS ?date2seconds2)
			BIND (?date2seconds1 + ?date2seconds2 AS ?date2addSeconds)
			
			BIND (?date2addSeconds - ?date1addSeconds AS ?diff)
			
			FILTER (?date1addSeconds < ?date2addSeconds)
		} ORDER BY ASC(?date2addSeconds)
	}
}""" .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b270 a <http://www.ajan.de/behavior/bt-ns#UpdateQuery>;
  <http://www.ajan.de/behavior/bt-ns#originBase> <http://www.ajan.de/ajan-ns#AgentKnowledge>;
  <http://www.ajan.de/behavior/bt-ns#sparql> """PREFIX ex: <http://example.org#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX suite: <http://www.dfki.de/suite-ns#>

INSERT {
ex:1 rdf:type suite:Activity ;
    suite:source \"http://127.0.0.1:5000/ml1/push\"^^xsd:anyURI ;
    suite:activityID \"171\"^^xsd:integer ;
    suite:activityType suite:tv_automatism;
    suite:confidence \"0.9735588\"^^xsd:float ;
    suite:from \"2020-12-11T01:58:22+00:00\"^^xsd:dateTime ;
    suite:to \"2020-12-11T02:00:42+00:00\"^^xsd:dateTime.

ex:2 rdf:type suite:Activity ;
    suite:source \"http://127.0.0.1:5000/ml2/push\"^^xsd:anyURI ;
    suite:activityID \"250\"^^xsd:integer ;
    suite:activityType suite:Kettle;
    suite:probability \"0.97710216\"^^xsd:float ;
    suite:from \"2020-12-11T07:21:17+00:00\"^^xsd:dateTime ;
    suite:to \"2020-12-11T07:25:06+00:00\"^^xsd:dateTime ;
    suite:state suite:Complete.

ex:3 rdf:type suite:Activity ;
    suite:source \"http://127.0.0.1:5000/ml0/push\"^^xsd:anyURI ;
    suite:activityID \"329\"^^xsd:integer ;
    suite:activityType suite:CoffeeMaking1;
    suite:probability \"0.96731335\"^^xsd:float ;
    suite:from \"2020-12-11T07:24:36+00:00\"^^xsd:dateTime ;
    suite:to \"2020-12-11T07:31:06+00:00\"^^xsd:dateTime ;
    suite:state suite:Complete.

ex:4 rdf:type suite:Activity ;
    suite:source \"http://127.0.0.1:5000/ml0/push\"^^xsd:anyURI ;
    suite:activityID \"331\"^^xsd:integer ;
    suite:activityType suite:CoffeeMaking2;
    suite:probability \"0.98904616\"^^xsd:float ;
    suite:from \"2020-12-11T07:35:27+00:00\"^^xsd:dateTime ;
    suite:to \"2020-12-11T07:35:57+00:00\"^^xsd:dateTime ;
    suite:state suite:Complete.
}
WHERE {
    ?s ?p ?o .
}""" .

<http://localhost:8090/rdf4j/repositories/behaviors#HandleMappingEvent-aae76624-fede-4415-b47f-cc9019bc9e5c>
  a <http://www.ajan.de/behavior/bt-ns#HandleMappingEvent>;
  <http://www.ajan.de/behavior/bt-ns#validate> _:genid-507939f1b83a43529ae9841b73a3dc3d-b257;
  rdfs:label "HandleILASPEvent";
  <http://www.ajan.de/ajan-ns#event> <http://localhost:8090/rdf4j/repositories/agents#EV_2c8de43e-0e84-4f75-a6df-832b87ae2f07>;
  <http://www.ajan.de/behavior/bt-ns#mapping> <http://localhost:8090/rdf4j/repositories/domain#ILASPMapping>;
  rdfs:comment "" .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b271 rdf:first <http://localhost:8090/rdf4j/repositories/domain#Training_Rules>;
  rdf:rest rdf:nil .

<http://localhost:8090/rdf4j/repositories/behaviors#Priority-fd8707da-11b0-48ef-ba67-a236f4caf936>
  a <http://www.ajan.de/behavior/bt-ns#Priority>;
  <http://www.ajan.de/behavior/bt-ns#hasChildren> _:genid-507939f1b83a43529ae9841b73a3dc3d-b272;
  rdfs:label "defaultPriority";
  rdfs:comment "" .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b272 rdf:first <http://localhost:8090/rdf4j/repositories/behaviors#Sequence-80ed8353-0483-4688-b5aa-1276720ce944>;
  rdf:rest _:genid-507939f1b83a43529ae9841b73a3dc3d-b273 .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b273 rdf:first <http://localhost:8090/rdf4j/repositories/behaviors#Sequence-275e9622-3377-4f0b-abdb-5c95a3d4a1db>;
  rdf:rest rdf:nil .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b274 rdf:first <http://localhost:8090/rdf4j/repositories/behaviors#Update-3cc5abc7-2267-4258-87e6-d684d0fbf910>;
  rdf:rest _:genid-507939f1b83a43529ae9841b73a3dc3d-b275 .

<http://localhost:8090/rdf4j/repositories/behaviors#Sequence-80ed8353-0483-4688-b5aa-1276720ce944>
  a <http://www.ajan.de/behavior/bt-ns#Sequence>;
  rdfs:label "defaultSequence";
  <http://www.ajan.de/behavior/bt-ns#hasChildren> _:genid-507939f1b83a43529ae9841b73a3dc3d-b277 .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b275 rdf:first <http://localhost:8090/rdf4j/repositories/behaviors#Update-ed160a97-8efe-4fb9-a6eb-d3f4016e384b>;
  rdf:rest _:genid-507939f1b83a43529ae9841b73a3dc3d-b276 .

<http://localhost:8090/rdf4j/repositories/behaviors#Update-606a9ef2-f286-4fed-be65-d1aae18b625c>
  a <http://www.ajan.de/behavior/bt-ns#Update>;
  <http://www.ajan.de/behavior/bt-ns#useW3C> false;
  rdfs:label "WriteRuleSet";
  rdfs:comment "";
  <http://www.ajan.de/behavior/bt-ns#query> _:genid-507939f1b83a43529ae9841b73a3dc3d-b256 .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b276 rdf:first <http://localhost:8090/rdf4j/repositories/behaviors#ILASPInput-b00de8e4-2795-4577-9b2f-4a1a8d172e90>;
  rdf:rest rdf:nil .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b277 rdf:first <http://localhost:8090/rdf4j/repositories/behaviors#HandleMappingEvent-aae76624-fede-4415-b47f-cc9019bc9e5c>;
  rdf:rest _:genid-507939f1b83a43529ae9841b73a3dc3d-b278 .

_:genid-507939f1b83a43529ae9841b73a3dc3d-b278 rdf:first <http://localhost:8090/rdf4j/repositories/behaviors#Update-606a9ef2-f286-4fed-be65-d1aae18b625c>;
  rdf:rest rdf:nil .
